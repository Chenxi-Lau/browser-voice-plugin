!function(e,s){"object"==typeof exports&&"object"==typeof module?module.exports=s():"function"==typeof define&&define.amd?define([],s):"object"==typeof exports?exports.SpeechJs=s():e.SpeechJs=s()}(self,(function(){return(()=>{"use strict";var e={d:(s,t)=>{for(var o in t)e.o(t,o)&&!e.o(s,o)&&Object.defineProperty(s,o,{enumerable:!0,get:t[o]})},o:(e,s)=>Object.prototype.hasOwnProperty.call(e,s)},s={};e.d(s,{default:()=>u});class t{#sounder=null;constructor(e){this.options=e}init(){const e=this.options;this.#sounder=new ActiveXObject("Sapi.SpVoice"),this.#sounder.volume=e.volume===speechOption.volume.LOW?20:e.volume==speechOption.volume.HIGHT?100:50,this.#sounder.rate=this.options.rate===speechOption.rate.SLOW?-5:e.rate==speechOption.rate.FAST?5:0}speak(e){const s=this.options,t=s.flags===speechOption.flags.ASYNC_SPEAK?1:s.flags===speechOption.flags.SYNC_SPEAK?2:3;this.#sounder.Speak(e,t)}pause(){this.#sounder.Pause()}resume(){this.#sounder.Resume()}stop(){this.#sounder.Speak("",speechOption.flags.PURGE_BEFORE_SPEAK)}}const o={ASYNC_SPEAK:1,SYNC_SPEAK:2,PURGE_BEFORE_SPEAK:3},n={LOW:"low",MIDDLE:"middle ",HIGHT:"hight"},r={SLOW:"slow",NORMAL:"normal ",FAST:"fast"};class i{#sounder=null;constructor(e){this.options=e}init(){const e=this.options;this.#sounder=new SpeechSynthesisUtterance,this.#sounder.volume=e.volume==n.LOW?.2:e.volume==n.HIGHT?1:.5,this.#sounder.rate=e.rate==r.SLOW?.1:e.rate==r.FAST?5:1}speak(e){this.#sounder.text=e,window.speechSynthesis.speak(this.#sounder)}pause(){window.speechSynthesis.pause()}resume(){window.speechSynthesis.resume()}stop(){window.speechSynthesis.cancel()}}const u=class{#sounder=null;#myBrowser=()=>{const e=navigator.userAgent,s=e.indexOf("Opera")>-1,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!s,o=e.indexOf("Safari")>-1&&-1==e.indexOf("Chrome"),n=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;return t?"IE":!(!o&&!n)&&"other"};#init=()=>{if(window._$sounder)throw new Error("当前页面只能初始化一个Sounder对象");const e=this.options||{volume:n.HIGHT,rate:r.NORMAL,flags:o.PURGE_BEFORE_SPEAK};if("object"!=typeof e||Array.isArray(e))throw new Error("不是有效的参数对象");const s=this.#myBrowser();if("IE"===s)this.#sounder=new t(e);else{if("other"!=s)throw new Error("Sorry！该浏览器暂不支持语音播报");this.#sounder=new i(e)}this.#sounder.init(),window._$sounder=this.#sounder};constructor(e){this.options=e,this.#init()}speak(e){"string"==typeof e&&this.#sounder.speak(e)}pause(){this.#sounder.pause()}resume(){this.#sounder.resume()}stop(){this.#sounder.stop()}};return s=s.default})()}));